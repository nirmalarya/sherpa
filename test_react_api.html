<!DOCTYPE html>
<html>
<head>
    <title>Test React API Integration</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        function SessionsList() {
            const [sessions, setSessions] = React.useState([]);
            const [loading, setLoading] = React.useState(true);
            const [error, setError] = React.useState(null);

            React.useEffect(() => {
                console.log('üîç Fetching sessions...');
                fetch('http://localhost:8001/api/sessions?status=active')
                    .then(response => {
                        console.log('Response status:', response.status);
                        return response.json();
                    })
                    .then(data => {
                        console.log('‚úÖ Data received:', data);
                        console.log('üìä Sessions count:', data.sessions?.length || 0);
                        setSessions(data.sessions || []);
                        setLoading(false);
                    })
                    .catch(err => {
                        console.error('‚ùå Error:', err);
                        setError(err.message);
                        setLoading(false);
                    });
            }, []);

            if (loading) return <div>Loading...</div>;
            if (error) return <div>Error: {error}</div>;
            if (sessions.length === 0) return <div>No active sessions</div>;

            return (
                <div>
                    <h2>Found {sessions.length} active sessions:</h2>
                    <ul>
                        {sessions.map(session => (
                            <li key={session.id}>
                                {session.spec_file || session.id} -
                                {session.completed_features}/{session.total_features} features
                            </li>
                        ))}
                    </ul>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<SessionsList />);
    </script>
</body>
</html>
